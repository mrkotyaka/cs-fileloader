# «Облачное хранилище»

## Введение
Разработан REST-сервис, предоставляющий REST-интерфейс для загрузки файлов и вывода списка уже загруженных файлов пользователя. 
Все запросы к сервису авторизованы. 
Заранее подготовленное веб-приложение (FRONT) подключается к разработанному сервису без доработок, а также использован функционал FRONT для авторизации, загрузки и вывода списка файлов пользователя.


## Реализованные требования к приложению
- Сервис предоставляет REST-интерфейс для интеграции с FRONT.
- Сервис реализовывает все методы, описанные в [yaml-файле](./CloudServiceSpecification.yaml):  
  1. Вывод списка файлов.  
  2. Добавление файла.  
  3. Удаление файла.  
  4. Авторизация.
- Все настройки вычитываются из файла настроек (yml).
- Информация о пользователях сервиса (логины для авторизации) и данные хранятся в базе данных PostgreSQL-15.

## Реализация
- Приложение разработано с использованием Spring Boot.
- Использован сборщик пакетов maven.
- Для запуска используется docker, docker-compose.
- Код покрыт unit-тестами с использованием mockito.
- Добавлены интеграционные тесты с использованием testcontainers.

## Авторизация приложения
FRONT-приложение использует header `auth-token`, в котором отправляет токен (ключ-строка) для идентификации пользователя на BACKEND.
Для получения токена нужно пройти авторизацию на BACKEND и отправить на метод  `/login` логин и пароль. 
В случае успешной проверки в ответ BACKEND должен вернуть json-объект с полем `auth-token` и значением токена. 
Все дальейшие запросы с FRONTEND, кроме метода `/login`, отправляются с этим `header`.
Для выхода из приложения нужно вызвать метод BACKEND `/logout`, который удалит/деактивирует токен. 
Последующие запросы с этим токеном будут не авторизованы и вернут код 401.

## Запуск приложения

Приложение работает на порту 8080. 
1. Запаковать проект и получить jar-файл (package).
2. Собрать docker образы и запустить контейнеры через файл [docker-compose.yml](./docker-compose.yml). 

Терминал выведет сообщение, что контейнеры запущены:
```java
[+] Running 3/3
 ✔ Network cs-fileloader_default  Created                                                                                                                0.1s 
 ✔ Container postgresql           Started                                                                                                                1.9s 
 ✔ Container cs-fileloader-app-1  Started 
```

## Эндпоинты (из спецификации):

✔ `POST /login` — возвращает JSON с полем auth-token.

✔ `POST /logout` — требует auth-token в заголовке; деактивирует токен.

✔ `POST /file?filename=...` — загрузка файла (multipart/form-data), header auth-token.

✔ `GET /file?filename=...` — скачивание файла, header auth-token.

✔ `DELETE /file?filename=...` — удаление файла, header auth-token.

✔ `PUT /file?filename=...` — переименование (в body JSON { "name": "newName" }), header auth-token.

✔ `GET /list?limit=...` — возвращает список файлов (JSON с filename и size), header auth-token.